name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  backend:
    name: Backend CI
    uses: ./.github/workflows/backend-ci.yml

  frontend:
    name: Frontend CI
    uses: ./.github/workflows/frontend-ci.yml

  status:
    name: CI Status
    runs-on: ubuntu-latest
    needs: [backend, frontend]
    if: always()

    steps:
      - name: Check CI results
        run: |
          if [ "${{ needs.backend.result }}" == "success" ] && [ "${{ needs.frontend.result }}" == "success" ]; then
            echo "All CI checks passed!"
            exit 0
          else
            echo "CI checks failed:"
            echo "  Backend: ${{ needs.backend.result }}"
            echo "  Frontend: ${{ needs.frontend.result }}"
            exit 1
          fi
